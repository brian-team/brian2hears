.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_simple_anf.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_simple_anf.py:


Auditory nerve fibre model
--------------------------
Example of a simple auditory nerve fibre model with Brian hears.



.. image:: /auto_examples/images/sphx_glr_simple_anf_001.png
    :class: sphx-glr-single-img





.. code-block:: default

    from brian2 import *
    from brian2hears import *

    sound1 = tone(1*kHz, .1*second)
    sound2 = whitenoise(.1*second)

    sound = sound1+sound2
    sound = sound.ramp()

    cf = erbspace(20*Hz, 20*kHz, 3000)
    cochlea = Gammatone(sound, cf)

    # Half-wave rectification and compression [x]^(1/3)
    ihc = FunctionFilterbank(cochlea, lambda x: 3*clip(x, 0, Inf)**(1.0/3.0))

    # Leaky integrate-and-fire model with noise and refractoriness
    eqs = '''
    dv/dt = (I-v)/(1*ms)+0.2*xi*(2/(1*ms))**.5 : 1 (unless refractory)
    I : 1
    '''
    anf = FilterbankGroup(ihc, 'I', eqs, reset='v=0', threshold='v>1', refractory=5*ms, method='euler')

    M = SpikeMonitor(anf)
    run(sound.duration)
    plot(M.t/ms, M.i, ',k')
    show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.183 seconds)


.. _sphx_glr_download_auto_examples_simple_anf.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: simple_anf.py <simple_anf.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: simple_anf.ipynb <simple_anf.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
